[project]
channels = ["conda-forge"]
name = "metadata-schema"
platforms = ["linux-64", "osx-64", "win-64"]
version = "0.3.0"

[tasks]
validate-objects = {cmd = [
    "bash", "-c",
    '''
    find . -type f -name "*.json" -exec sed -i '/$id/d' {} +
    for file in curation eln experimental figure_description projects source system; do
        check-jsonschema --schemafile ./schemas/${file}.json ./examples/objects/${file}.yaml
    done
    '''
]}
validate-file-schemas = {cmd = [
    "bash", "-c",
    '''
    find . -type f -name "*.json" -exec sed -i '/$id/d' {} +
    for file in autotag svgdigitizer; do
        check-jsonschema --schemafile ./schemas/${file}.json ./examples/file_schemas/${file}.yaml
    done
    '''
]}
validate-package-schemas = {cmd = [
    "bash", "-c",
    '''
    check-jsonschema --schemafile ./schemas/echemdb_package.json ./examples/file_schemas/echemdb_package.json
    check-jsonschema --schemafile ./schemas/svgdigitizer_package.json ./examples/file_schemas/svgdigitizer_package.json
    '''
]}
validate = { depends-on = ["validate-objects", "validate-file-schemas", "validate-package-schemas"] }

[dependencies]
check-jsonschema = "*"
