{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "svgdigitizer Data Package Profile",
  "description": "Data package schema for svgdigitizer output following the Frictionless Data Package specification with simplified echemdb metadata.",
  "type": "object",
  "allOf": [
    {
      "$ref": "https://datapackage.org/profiles/2.0/datapackage.json"
    }
  ],
  "properties": {
    "resources": {
      "type": "array",
      "items": {
        "allOf": [
          {
            "$ref": "https://datapackage.org/profiles/2.0/dataresource.json"
          },
          {
            "$ref": "#/definitions/svgdigitizer_resource"
          }
        ]
      }
    }
  },
  "definitions": {
    "svgdigitizer_resource": {
      "type": "object",
      "description": "A resource created by svgdigitizer with minimal echemdb metadata.",
      "properties": {
        "metadata": {
          "type": "object",
          "description": "Metadata container for the digitized resource.",
          "required": [
            "echemdb"
          ],
          "properties": {
            "echemdb": {
              "type": "object",
              "description": "Simplified echemdb metadata for digitized data.",
              "required": [
                "figureDescription"
              ],
              "properties": {
                "experimental": {
                  "type": "object",
                  "description": "Experimental tags or keywords.",
                  "properties": {
                    "tags": {
                      "type": "array",
                      "description": "List of tags describing the experiment or measurement.",
                      "example": [
                        "CV",
                        "ORR",
                        "alkaline"
                      ],
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "figureDescription": {
                    "type": "object",
                    "additionalProperties": false,
                    "title": "figureDescription",
                    "description": "Description of the data to a figure or plot including data type and measurement details.",
                    "properties": {
                      "type": {
                        "type": "string",
                        "description": "Source or origin of the data.",
                        "example": "raw",
                        "anyOf": [
                          {
                            "const": "digitized",
                            "description": "Data extracted from a figure using software (e.g., svgdigitizer)."
                          },
                          {
                            "const": "raw",
                            "description": "Original data as recorded by the instrument."
                          },
                          {
                            "const": "simulated",
                            "description": "Data generated by simulation software."
                          },
                          {
                            "const": "processed",
                            "description": "Data generated by processing raw or simulated data."
                          }
                        ]
                      },
                      "measurementType": {
                        "type": "string",
                        "description": "Acronym type for the measurement performed, such as CV; EIS, XPS, etc.",
                        "example": "CV"
                      },
                      "simultaneousMeasurements": {
                        "type": "array",
                        "description": "Other measurements performed simultaneously, such as ring current, IR, Raman, ICP-MS.",
                        "items": {
                          "type": "string"
                        }
                      },
                      "comment": {
                        "type": "string",
                        "description": "Additional notes about the figure or data.",
                        "example": "Data below 0 V was cut off by the x-axis."
                      },
                      "fields": {
                        "type": "array",
                        "description": "Description of data fields/columns in the figure.",
                        "items": {
                          "$ref": "#/definitions/Field"
                        }
                      },
                      "scanRate": {
                        "description": "Scan rate used in the measurement.",
                        "$ref": "#/definitions/ScanRate"
                      }
                    },
                    "required": [
                      "type"
                    ]
                  },
                  "source": {
                    "type": "object",
                    "description": "Source publication information for digitized data.",
                    "properties": {
                      "figure": {
                        "type": "string",
                        "description": "Figure identifier in the source publication.",
                        "example": "2a"
                      },
                      "curve": {
                        "type": "string",
                        "description": "Specific curve identifier within the figure.",
                        "example": "blue"
                      },
                      "citationKey": {
                        "type": "string",
                        "description": "BibTeX citation key for the source following `<FirstAuthorName>_<Year>_<FirstWordOfTitle>_<FirstPageNumber>` format.",
                        "example": "doe_2024_electrochemistry_543"
                      },
                      "url": {
                        "type": "string",
                        "format": "uri",
                        "pattern": "^https?://.*$",
                        "default": "https://",
                        "description": "URL or DOI of the source publication.",
                        "example": "https://example.org"
                      },
                      "techniques": {
                        "type": "array",
                        "description": "Techniques used in the source data.",
                        "example": [
                          "CV",
                          "EIS",
                          "XPS"
                        ],
                        "contains": {
                          "type": "string"
                        }
                      }
                    }
                  }
                },
                "additionalProperties": true
              }
            }
          }
        }
      }
    },
    "ScanRate": {
      "type": "object",
      "title": "scan rate",
      "description": "A physical quantity with a value, unit, and optional uncertainty.",
      "additionalProperties": false,
      "properties": {
        "value": {
          "$ref": "#/definitions/Value"
        },
        "uncertainty": {
          "$ref": "#/definitions/Uncertainty"
        },
        "unit": {
          "$ref": "#/definitions/Unit"
        },
        "comment": {
          "type": "string",
          "description": "Additional notes about the measurement or quantity.",
          "example": "Measured at room temperature"
        },
        "calculation": {
          "type": "string",
          "description": "Method or formula used to calculate this quantity.",
          "example": "Obtained by multiplying U and I"
        }
      }
    },
    "Field": {
      "title": "Field",
      "description": "Description of a data field (column) compatible with frictionless table-schema and extended with echemdb-specific properties for physical quantities.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "Name of the data field. Use single letters for specific systems. Otherwise use descriptive names like 't_rel', 'E_WE', or 'j_WE'.",
          "example": "E_WE"
        },
        "type": {
          "type": "string",
          "description": "Data type of the field (string, number, integer, boolean, object, array, date, time, datetime, year, duration, geopoint, geojson, any).",
          "example": "number"
        },
        "format": {
          "type": "string",
          "description": "Format specification for the field type (default, email, uri, binary, uuid for strings; default for numbers).",
          "example": "default"
        },
        "title": {
          "type": "string",
          "description": "A human-readable title for this field."
        },
        "description": {
          "type": "string",
          "description": "A description of that field.",
          "example": "The potential measured between the working electrode and reference electrode."
        },
        "dimension": {
          "type": "string",
          "description": "Physical dimension of the field (e.g., 'time', 'potential', 'current density').",
          "example": "potential"
        },
        "unit": {
          "type": "string",
          "description": "Unit of measurement for this field (SI or conventional electrochemical units), following astropy's string unit notation.",
          "example": "V"
        },
        "reference": {
          "type": "string",
          "description": "Reference electrode or reference point for this measurement (electrochemistry-specific).",
          "example": "RHE"
        },
        "orientation": {
          "type": "string",
          "description": "Axis orientation in plots (horizontal for x-axis, vertical for y-axis).",
          "example": "horizontal",
          "enum": [
            "horizontal",
            "vertical"
          ]
        }
      },
      "required": [
        "name"
      ]
    },
    "Uncertainty": {
      "type": "object",
      "title": "Uncertainty",
      "description": "Uncertainty information for a measured quantity.",
      "properties": {
        "value": {
          "type": "number",
          "description": "Symmetric uncertainty value (Â±).",
          "example": 0.01
        },
        "unit": {
          "type": "string",
          "description": "Unit of the uncertainty value.",
          "example": "mol / l"
        },
        "positiveValue": {
          "type": "number",
          "description": "Upper bound (+) for asymmetric uncertainties.",
          "example": 0.02
        },
        "negativeValue": {
          "type": "number",
          "description": "Lower bound (-) for asymmetric uncertainties.",
          "example": 0.01
        },
        "comment": {
          "type": "string",
          "description": "Additional information about the uncertainty estimation.",
          "example": "Standard deviation from 3 replicate measurements"
        },
        "type": {
          "type": "string",
          "description": "Type of uncertainty (absolute or relative).",
          "example": "absolute",
          "enum": [
            "absolute",
            "relative"
          ]
        }
      },
      "additionalProperties": false,
      "minProperties": 1
    },
    "Unit": {
      "anyOf": [
        {
          "type": "integer"
        },
        {
          "type": "null"
        },
        {
          "type": "string"
        }
      ],
      "title": "Unit",
      "description": "Unit of measurement as a string (e.g., 'mol / l', 'V', 'mA / cm2').",
      "example": "mol / l"
    },
    "Value": {
      "anyOf": [
        {
          "type": "number"
        },
        {
          "type": "null"
        },
        {
          "type": "string"
        }
      ],
      "title": "Value",
      "description": "Numerical value (can be a number, string, or null).",
      "example": 0.5
    }
  }
}
